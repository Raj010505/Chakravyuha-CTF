#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>

void setup() {
    setvbuf(stdout, NULL, _IONBF, 0);
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stderr, NULL, _IONBF, 0);
}

void win() {
    printf("Congratulations! Here is your flag: G8KEY{RED_GATE_TRAP}\n");
    fflush(stdout);
    exit(0);
}

void vuln() {
    char buffer[64];
    printf("Input: ");
    gets(buffer); // Vulnerable function
}

int main() {
    setup();
    printf("Welcome to Here's a Libc challenge! Leak libc, return to win!\n");
    vuln();
    return 0;
}
